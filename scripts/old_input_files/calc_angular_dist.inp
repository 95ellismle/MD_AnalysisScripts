######################################
#                                    #
# An input file to calculate and     #
# save the angular distribution of   #
# the long and short axes of a       #
# pentacene system.                  #
######################################

# Set some filepath variables
folder = "/home/oem/Data/Pentacene_Crystal_Melt/xyz_md"
filepath = "$folder/snapshot450000.dat"

count = 0
   
# Read data from a Lammps snapshot
load $filepath lammps_dump as data

# Tell the code we are using pentacene
#  and give some other paramaters
set system data to pentacene
data['number_bins'] = 400
data['coordinate_wrapping'] = "unwrapped"

# Calculate the angular distribution
calc angular_dist from data as ang_dist

# Plot the angular distribution
python {
    # Plot the angular distribution
    import matplotlib.pyplot as plt

    ang_dist.data.plot()
    
    plt.show()

#    # Make a folder and save the plot
#    import os, re
#
#    savefold = "Pentacene_Crystal_Img"
#    if not os.path.isdir(savefold):
#        os.mkdir(savefold)
#
#    img_num = re.findall("[0-9]+", filepath[filepath.rfind('/'):])[0]
#    print(filepath, img_num)
#    img_num = img_num.zfill(7)
#    plt.savefig(f"{savefold}/angular_dist_{img_num}.png")
#    plt.close()
}
count = count + 1


## Write the angular distribution as a json file
#write ang_dist "ang_dist.json" as json
#write data "test.xyz" as xyz
