#####################################################
#                                                   #
# Will try and find molecular layers in a structure #
# The algorithm works by aligning the z axis of the #
# whole structure along the standard long axis      #
# (this is calculated from the peak of a histogram  #
# of the long axis vectors). A window is then       #
# scanned along the z axis of the rotated structure #
# and the number of atoms are counted within this   #
# window. The layers are defined by the troughs in  #
# the resulting distribution.                       #
#####################################################

filepath_pos = "/home/oem/Data/Final_Pentacene_10ns_Quench/snapshot9995000.dat"
read $filepath_pos lammps_dump into pos

set system pos to pentacene

pos['allow_boundaries'] = True
pos['plot_layers'] = True

calc mol_layers from pos as layers
